<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paul Robinson">
<meta name="dcterms.date" content="2024-08-17">
<meta name="description" content="An introduction to statistical modelling and inference via regression on one outcome and one predictor">

<title>2: Simple linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="forest">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Paul Robinson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../statsposts.html"> 
<span class="menu-text">Data science blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../sl-wildlife-posts.html"> 
<span class="menu-text">Sierra Leone Wildlife blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../wildlife-tourism.html"> 
<span class="menu-text">Wildlife tourism</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../linux-posts.html"> 
<span class="menu-text">Linux resources</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/paulauvirage" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">2: Simple linear regression</h1>
                  <div>
        <div class="description">
          An introduction to statistical modelling and inference via regression on one outcome and one predictor
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">regression</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Paul Robinson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 17, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">September 6, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#working-example---trophy-hunting-of-lions" id="toc-working-example---trophy-hunting-of-lions" class="nav-link active" data-scroll-target="#working-example---trophy-hunting-of-lions"><span class="header-section-number">1</span> Working example - trophy hunting of lions</a></li>
  <li><a href="#the-objectives-of-regression" id="toc-the-objectives-of-regression" class="nav-link" data-scroll-target="#the-objectives-of-regression"><span class="header-section-number">2</span> The objectives of regression</a></li>
  <li><a href="#analysis-of-the-lion-nose-data-with-r" id="toc-analysis-of-the-lion-nose-data-with-r" class="nav-link" data-scroll-target="#analysis-of-the-lion-nose-data-with-r"><span class="header-section-number">3</span> Analysis of the lion nose data with R</a>
  <ul class="collapse">
  <li><a href="#step-1.-subject-matter-questions" id="toc-step-1.-subject-matter-questions" class="nav-link" data-scroll-target="#step-1.-subject-matter-questions"><span class="header-section-number">3.1</span> Step 1. Subject matter questions</a></li>
  <li><a href="#step-4.-exploratory-data-analysis-eda-jumping-steps-2-study-design-and-3-measurement-validity-as-existing-data-is-being-used." id="toc-step-4.-exploratory-data-analysis-eda-jumping-steps-2-study-design-and-3-measurement-validity-as-existing-data-is-being-used." class="nav-link" data-scroll-target="#step-4.-exploratory-data-analysis-eda-jumping-steps-2-study-design-and-3-measurement-validity-as-existing-data-is-being-used."><span class="header-section-number">3.2</span> Step 4. Exploratory data analysis (EDA), jumping Steps 2 (Study Design) and 3 (Measurement validity) as existing data is being used.</a></li>
  <li><a href="#step-5.-model-formulation-and-inference" id="toc-step-5.-model-formulation-and-inference" class="nav-link" data-scroll-target="#step-5.-model-formulation-and-inference"><span class="header-section-number">3.3</span> Step 5. Model formulation and inference</a></li>
  </ul></li>
  <li><a href="#modelling-process-following-ros-chs-6-9" id="toc-modelling-process-following-ros-chs-6-9" class="nav-link" data-scroll-target="#modelling-process-following-ros-chs-6-9"><span class="header-section-number">4</span> Modelling process (following ROS chs 6-9)</a></li>
  <li><a href="#bayes-rules-modelling-sequence-from-chapter-9" id="toc-bayes-rules-modelling-sequence-from-chapter-9" class="nav-link" data-scroll-target="#bayes-rules-modelling-sequence-from-chapter-9"><span class="header-section-number">5</span> Bayes Rules modelling sequence; from Chapter 9</a>
  <ul class="collapse">
  <li><a href="#specify-the-data-model" id="toc-specify-the-data-model" class="nav-link" data-scroll-target="#specify-the-data-model"><span class="header-section-number">5.1</span> specify the data model</a></li>
  <li><a href="#specify-the-priors" id="toc-specify-the-priors" class="nav-link" data-scroll-target="#specify-the-priors"><span class="header-section-number">5.2</span> Specify the priors</a></li>
  <li><a href="#posterior-simulation" id="toc-posterior-simulation" class="nav-link" data-scroll-target="#posterior-simulation"><span class="header-section-number">5.3</span> Posterior simulation</a></li>
  </ul></li>
  <li><a href="#present-conclusions" id="toc-present-conclusions" class="nav-link" data-scroll-target="#present-conclusions"><span class="header-section-number">6</span> Present conclusions</a></li>
  <li><a href="#interpret-in-subject-matter-terms" id="toc-interpret-in-subject-matter-terms" class="nav-link" data-scroll-target="#interpret-in-subject-matter-terms"><span class="header-section-number">7</span> Interpret in subject matter terms</a>
  <ul class="collapse">
  <li><a href="#notes-on-stuff-to-addadded" id="toc-notes-on-stuff-to-addadded" class="nav-link" data-scroll-target="#notes-on-stuff-to-addadded"><span class="header-section-number">7.1</span> Notes on stuff to add/added</a></li>
  <li><a href="#refs-and-open-books-to-add" id="toc-refs-and-open-books-to-add" class="nav-link" data-scroll-target="#refs-and-open-books-to-add"><span class="header-section-number">7.2</span> refs and open books to add</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-page-left" id="quarto-document-content">





<p>To start, click on the right hand arrow in the “Document structure” box, below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Document structure
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This tutorial assumes that you are working in R Studio.</p>
<p>The main text followed is <span class="citation" data-cites="Gelman_Hill_Vehtari_2020">(<a href="#ref-Gelman_Hill_Vehtari_2020" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span>, available for <a href="https://avehtari.github.io/ROS-Examples/index.html">free download</a>. Supplementary recommended books are <span class="citation" data-cites="Fox_Weisberg_2018">(<a href="#ref-Fox_Weisberg_2018" role="doc-biblioref">Fox and Weisberg 2018</a>)</span>, <span class="citation" data-cites="Alexander_2023">(<a href="#ref-Alexander_2023" role="doc-biblioref">Alexander 2023</a>)</span> available <a href="https://tellingstorieswithdata.com/">free to read online</a>.</p>
<p>As with all posts in this group, the main text is interspersed with two types of blocks.</p>
<p><strong>Call-outs</strong> of supporting information, such as this one, are folded away to avoid their interfering with a first read of the post. I recommend reading them all. You can unfold them by clicking on the far right arrow inside the box.</p>
<p><strong>Code blocks</strong> are folded away with an arrow to the left of the numbered code block, for example <code>Code 2.1 Import packages to session</code>. They allow you to implement all of the analysis in the post on your computer. Each code block has numbered notes to the right, referring to particular lines. Click on the number and a box will pop up with a brief explanation of the code. Click again and the pop up closes. I am assuming you read the posts in sequence, so the earlier posts will have pop up explanations that are not repeated in the later code blocks. You can cut and paste the code in each code block into your own R scripting window in R Studio, by clicking on the clipboard in the right end of the block, but I recommend your typing it in, to get practice in how R code works in R Studio.</p>
</div>
</div>
</div>
<section id="working-example---trophy-hunting-of-lions" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="working-example---trophy-hunting-of-lions"><span class="header-section-number">1</span> Working example - trophy hunting of lions</h2>
<p>Trophy hunting of lions, particularly males, is a controversial, but <a href="https://www.discountafricanhunts.com/hunts/hunt-lion-in-tanzania.html#:~:text=Hunt%20Lion%20in%20Tanzania&amp;text=Rifle%20Only%201%20x%201%20Starting%20at%20%2455%2C000!">active</a>, means of conserving populations. Selective killing of older lions is thought to result in fewer knock-on deaths, as older animals are less likely to be breeding and the killing of a younger breeding male can result in further lion deaths, particularly through infanticide, as a new male replaces the killed male in the pride <span class="citation" data-cites="whitman2004">(<a href="#ref-whitman2004" role="doc-biblioref">Whitman et al. 2004</a>)</span>, <span class="citation" data-cites="loveridge2023">(<a href="#ref-loveridge2023" role="doc-biblioref">Loveridge et al. 2023</a>)</span>. The amount of black on a lion’s nose is the best remote indicator of age . This measure has been taken for lions of known age in a long term study at the Serengeti, Tanzania. The data is available for re-analysis in the R package <code>abd</code> and has been used for an example of linear regression in the online book <a href="https://statistics4ecologists-v2.netlify.app/linreg">Statistics for ecologists</a> <span class="citation" data-cites="fieberg_2024">(<a href="#ref-fieberg_2024" role="doc-biblioref">Fieberg 2024</a>)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The advantages of open data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This worked example is possible because the data has been made easily, publicly accessible. It is not essential, though it is helpful, that it is accessible through an <code>R</code> package. In a later post an optimal workflow for scientists will be discussed in which open data is a component.</p>
</div>
</div>
</div>
</section>
<section id="the-objectives-of-regression" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="the-objectives-of-regression"><span class="header-section-number">2</span> The objectives of regression</h2>
<p>Let’s review what regression aims to do, applied to the lion nose data, in the call-out box below.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The objectives of regression
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Regression is the most widely used method of <strong>statistical inference</strong>, generalising from the sample on which measurements have been taken to the population for which a hypothesis or, more often and more usefully, the size and direction of effects, is sought.</p>
<p>The sample data for a regression problem, gathered for the project or reused, contains, for each unit on which measurements have been taken, the <strong>outcome</strong> it is hope to explain and one or more <strong>predictors</strong> which it is hoped can explain variability in the outcome with sufficient precision to be useful.</p>
<p>Regression, and statistical inference more generally, is therefore a problem of prediction in the face of uncertainty. There is uncertainty about whether:</p>
<ul>
<li>the sample represents the population;</li>
<li>the measurements are truly measuring the features of interest (“measurement validity”); and</li>
<li>the mathematical relation between outcome and predictor is causal.</li>
</ul>
<p>Regression usually seeks to predict the average outcome for the predictor(s). To be more explicit in applying this reasoning to the lion nose data set, the predictor is the amount of black on the nose and the outcome which it is aimed to predict is the age of a lion for which the predictor (nose black marks) has been measured, but the outcome (age) is not known.</p>
<p>An hypothesis test could establish whether or not there is a relation between measured nose markings and age, usually phrased as a <strong>null hypothesis</strong>; H<sub>0</sub> there is no relation, versus the <strong>alternative hypothesis</strong> that H<sub>0</sub> is not supported.</p>
<p>This course will not concern itself much with hypothesis testing, but rather the more useful measurement of effects; is there a predictable change in the amount nose marking with age?</p>
<p>It is very unlikely that every lion of a certain age will have exactly the same amount of nose markings. If this was true, you would not need to use statistics, but rather simple algebra. Variability, arising from whatever processes cause nose markings and/or measurement error, are likely to give a range of values for lions of the same age. A regression model uses this variability and the size of the sample data (number of individuals with both nose marking and age measured) to estimate and report on the uncertainty in any prediction. Depending on the method of inference used - Frequentist or Bayesian - the uncertainty is reported as <strong>confidence intervals</strong> or <strong>credible intervals</strong> which have subtly different meanings. This will be discussed more later. What is important to remember is that statistical modelling, as opposed to deterministic modelling, is: necessary when there is variability in the data; and is reported with measures of uncertainty. <em>add important uses of regression from Gelman p5?</em></p>
</div>
</div>
</div>
</section>
<section id="analysis-of-the-lion-nose-data-with-r" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="analysis-of-the-lion-nose-data-with-r"><span class="header-section-number">3</span> Analysis of the lion nose data with R</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A[Question] --&gt; B(Data)
  B --&gt; C(Tidy)
  C --&gt; D(Exploratory analysis)
  D --&gt; E{Model}
  E --&gt; F[Interpret]
  E --&gt; G[Report]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A recap of the ideal sequence of a statistical investigation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will follow <span class="citation" data-cites="Cox_Donnelly_2011">(<a href="#ref-Cox_Donnelly_2011" role="doc-biblioref">Cox and Donnelly 2011</a>)</span> in defining seven steps for an applied statistical investigation that integrates the subject matter (lion nose markings and age) and statistical techniques.</p>
<ol type="1">
<li>Formulate and clarify a research question of subject-matter importance</li>
</ol>
<ul>
<li>Don’t waste your time on questions for which few people are interested in the answer; make the question(s) clear.</li>
</ul>
<ol start="2" type="1">
<li>Design an investigation to produce secure answers.</li>
</ol>
<ul>
<li>bbb</li>
</ul>
<ol start="3" type="1">
<li>Produce effective and reliable measurement procedures.</li>
</ol>
<ul>
<li>ccc</li>
</ul>
<ol start="4" type="1">
<li>Preliminary analysis</li>
</ol>
<ul>
<li>Often referred to as Exploratory Data Analysis (EDA). Use simple methods with visuals and tables to check data and inform on model choise</li>
</ul>
<ol start="5" type="1">
<li>Model formulation and inference</li>
</ol>
<ul>
<li>Develop and apply a model to give answers, with some assessment of thier uncertainty</li>
</ul>
<ol start="6" type="1">
<li>Present conclusions</li>
</ol>
<ul>
<li>eee</li>
</ul>
<ol start="7" type="1">
<li>Interpret in subject matter terms and in relation to the knowledge base of the field</li>
</ol>
<ul>
<li>fff</li>
</ul>
</div>
</div>
</div>
<section id="step-1.-subject-matter-questions" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="step-1.-subject-matter-questions"><span class="header-section-number">3.1</span> Step 1. Subject matter questions</h3>
<p>When possible choose an important question that is likely to be soluble from the data. The Lion is classified as globally <a href="https://www.iucnredlist.org/species/15951/259030422">Vulnerable</a>. Trophy hunting is economically valuable. Therefore an investigation of how selective trophy hunting could minimise the impact on the lion population size is of importance. There is evidence that trophy hunting older lions could cause less impact on the population and that lion age can be measured unobtrusively from the amount of black marking on the nose. The broad questions are:</p>
<ol type="a">
<li>Is there a difference in nose marking with age (hypothesis test)?</li>
<li>Can the difference be modeled to provide a measure of how nose markings change with age (regression model); and</li>
<li>Can the model be applied, for example to regulate permits for trophy hunting?</li>
</ol>
</section>
<section id="step-4.-exploratory-data-analysis-eda-jumping-steps-2-study-design-and-3-measurement-validity-as-existing-data-is-being-used." class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="step-4.-exploratory-data-analysis-eda-jumping-steps-2-study-design-and-3-measurement-validity-as-existing-data-is-being-used."><span class="header-section-number">3.2</span> Step 4. Exploratory data analysis (EDA), jumping Steps 2 (Study Design) and 3 (Measurement validity) as existing data is being used.</h3>
<p>Let’s start with question b. The data is already collected, so the usual <strong>Step 2</strong> of designing a study to collect data and <strong>Step 3</strong> of measurement validity are not necessary. However, you should read the papers that have been produced using the data, as how the data was gathered (both design and measurement) could affect how it can be interpreted. Maybe contact the authors if you have a query.</p>
<p>A first task, and so usually the first lines of <code>R</code> code, is to import into the analysis session, from your local library on your computer, the necessary R packages for the data handling, manipulation and analysis (<code>Code 3.1</code>) Next, import the data into your session (<code>Code 3.2</code>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Package management in R
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you are familiar with software that comes ready packaged with all of its capabilities, R may seem strange. It follows a different philosophy of bundling up one or a few related tasks into a package. When R is first downloaded onto your computer, it comes with 15 “base” packages, of the c21,000 packages available in the cloud on the <a href="https://cran.r-project.org/web/packages/">Comprehensive R Archive network</a> and others available from other cloud storage locations.</p>
<p>Any analysis usually needs more than the base packages. This course will use an extra 20 or so. You can, with an internet connection, download and install any extra packages onto your computer, where they will be added to your package library (see the packages tab in R Studio’s lower right window). As developers work on packages, the changed version needs to be updated on your computer. You will not be prompted to update. In R Studio the ‘packages’ then ‘update’ tab (bottom right window) is available for this. It will, with an internet connection, search for those of your installed packages that have updates and give you the option to install the updated versions. Most packages are less than 1MB in size and few more than 5MB, so I recommend you check and update packages as often as you have a stable internet connection. I have about 100 packages and update (there usually is something to update) daily, but less often is fine.</p>
<p>Once a package is on your computer, it is not yet available to use in your current analysis session. For this you need to import the package from your library, with a line of code using the <code>library</code> function; for example <code>library(marginaleffects)</code> to import the Marginal Effects package. Repeat this for each package. In writing a script of R code for any work, you usually start with lines to import the necessary packages, as without them the subsequent code depending on them will not run.</p>
</div>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>R Code 2.1</strong> Import packages from your library into the current analysis session.</span></div></div>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>R Code 2.1</summary>
<div class="sourceCode cell-code" id="annotated-cell-1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(abd) <span class="co"># a biological data package that includes the lion nose data</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># eight packages including ggplot2 for data visualisation</span></span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm) <span class="co"># Bayesian inference</span></span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstantools)</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="annotated-cell-1-19"><a href="#annotated-cell-1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19" data-code-annotation="1">The first lines of any <code>R</code> script usually add packages from your library into your current work session with the <code>library</code> function. If you do not have one or more of these packages installed you will need to first run <code>install.packages(abd)</code> etc or alternatively, if the package is on<code>CRAN</code> (Comprehensive R Archive Network’s 21,000 packages) use the package -&gt; install button in R Studio’s lower right window and follow the instructions.</span>
</dd>
</dl>
</div>
</div>
<p>The data added.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside"><strong>R Code 2.2</strong> Import the data</span></div></div>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>R Code 2.2</summary>
<div class="sourceCode cell-code" id="annotated-cell-2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>lion_noses <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(LionNoses)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Load <code>LionNoses</code> from the <code>abd</code> package into a data.frame</span>
</dd>
</dl>
</div>
</div>
<p>In your R Studio session, two things have changed. In the top right window under the <code>Environment</code> tab, the data is now loaded and available for analysis, with a description of the number of observations (measured lions) and variables. Click on the blue button in the left and the variables are listed, with their names and type (numerical). If you click on the white rectangle to the right of the text, the full data set appears as a file in the top right window, in a form known as a dataframe in R. The data is in the correct “tidy” format for analysis; one observation (lion) per row and each variable as a column. Hover over the column title and there is a summary of the variable type and range of values. The data is ready for analysis, which is reassuring. Often if acquiring data from someone else, and especially someone who uses Excel, tidying the data to get it in a format for analysis in R or any other statistical software can be a major piece of work.</p>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.3 Look at the data</summary>
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(lion_noses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">lion_noses</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.31</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">5.85</td>
<td style="text-align: right;">13.10</td>
<td style="text-align: left;">▇▃▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">proportion.black</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: left;">▇▃▂▁▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As our question is whether there is a relation between lion age and nose markings, a suitable exploratory visualisation is a scatterplot of these two variables. By convention, the outcome variable (age) is put on the y axis and the predictor (nose marking) on the x axis. The nose markings are reported as proportions in the original data. Percentages can be more familiar, so lets create a new variable, <code>percentage.black</code> by multiplying the proportions by 100 then use this variable in the plot and subsequent analysis (<code>Code 3.3</code> below).</p>
<div class="cell page-columns page-full" data-code-block-bg="true" data-highlight-style="github" data-cap-location="margin">
<details class="code-fold">
<summary>Code 3.3 Create new variable and plot lion nose data</summary>
<div class="sourceCode cell-code" id="annotated-cell-4" data-cap-location="margin" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>lion_noses <span class="ot">&lt;-</span> lion_noses <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage.black =</span> <span class="dv">100</span><span class="sc">*</span>proportion.black)</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lion_noses, <span class="fu">aes</span>(percentage.black, age)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-5" class="code-annotation-target"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4">4</button><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5">5</button><span id="annotated-cell-4-7" class="code-annotation-target"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Percentage of nose black"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Age (years)"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="6">6</button><span id="annotated-cell-4-9" class="code-annotation-target"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">5</span>, <span class="at">xmax =</span> <span class="dv">35</span>, <span class="at">ymin =</span> <span class="fl">0.5</span>,</span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="fl">4.8</span>, <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">22</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"91% of lions under 5 years have 40% or less nose black"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">41</span>, <span class="at">xmax =</span> <span class="dv">80</span>, <span class="at">ymin =</span><span class="dv">5</span>,</span>
<span id="annotated-cell-4-13"><a href="#annotated-cell-4-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> <span class="dv">9</span>, <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-4-14"><a href="#annotated-cell-4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">60</span>, <span class="at">y =</span> <span class="fl">9.6</span>, <span class="at">label =</span> <span class="st">"70% of lions over 5 years have more than 40% nose black"</span>, <span class="at">colour =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="dv">3</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Two things are happening here. First the lion_noses data is being “piped” with the pipe operator <code>|&gt;</code> into the second line, so we don’t have to specify it again. Then, the <code>mutate</code> function is used to create a new variable column named percentage.black by multiplying (<code>*</code>) proportion.black by 100.<br>
</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Create a ggplot object with the <code>lion_noses</code> data, with the predictor variable <code>proportion.black</code> on the x axis and the outcome <code>age</code> on the y axis. The <code>aes</code> function, abbreviated from aesthetic, specifies the graph layout and other features, in this case simply which variables are to be on the x and y axes, in that sequence.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="5" data-code-annotation="3">Add a scatterplot of the data with <code>geom_point</code></span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6" data-code-annotation="4">Change the ggplot theme to black &amp; white, see <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a> for other options</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="7,8" data-code-annotation="5">Specify the x and y axis labels with <code>xlab</code> and <code>ylab</code></span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="9,10,11,12,14" data-code-annotation="6">With the <code>ggplot2</code> function <code>annotate</code> add boxes and text inside the plot. Note that the position of both uses the values of the variables on the x and y axes</span>
</dd>
</dl>
</div>
<div class="cell-output-display page-columns page-full">
<div id="fig-cap-margin" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-cap-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-cap-margin-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cap-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Scatterplot of lion nose markings and age
</figcaption>
</figure>
</div>
</div>
</div>
<p>The scatterplot above (from Code 3.3) shows that there is a trend of increased black on the nose with age, but with variability and with fewer samples for older lions.</p>
<p>add quote on stats being extracting meaning/information from data, but add best possible information, so the meaning is in the model, ble/green box example just a poor model. he non model is usggesting all we need to know is in the data, whilst we know it is imprecise (sampling variability) and the meaning is in a model. Model vs non model.</p>
</section>
<section id="step-5.-model-formulation-and-inference" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="step-5.-model-formulation-and-inference"><span class="header-section-number">3.3</span> Step 5. Model formulation and inference</h3>
<p>Certainly there is, with variability, an increase in nose markings with age. The first model fit, which we may complicate later, is to suggest a straight line fit. As our data have only one predictor this is a <strong>simple linear regression</strong> with nose markings predicting age.</p>
<p>The model, let’s call it <strong><em>m1</em></strong>, is:</p>
<p>y = intercept + slope*percentage.black + error</p>
<p>If you remember WASSCE maths, this is the straight line formula <code>y = mx + c</code>, where m is the slope of the straight line and c is the intercept where the line meets the y axis with the addition of what statisticians call, unfortunately, error. In fact error is anything that may account for uncertainty and so an imperfect fit. This could be measurement error on the nose markings, but also other variables, not measured and so not in this model, that may influence nose markings, for example the lifetime health of a lion. It is unlikely can nose marking will perfectly predict age, like tree rings.</p>
<p>Slope and Intercept are <strong>parameters</strong>, for which m1, constrained as a straight line model, will select measures, given the data, which are in some mathematical sense a best fit of the data to the line.</p>
<p>At this stage, I do not want to complicate things with discussing whether classical or Bayesian inference should be used. We shall dodge the issue for now by running the model with the Bayesian inference package <code>rstanarm</code> with flat priors, which is identical to a classical fit. This may mean nothing, but don’t worry for now. We will return to this. Let’s run the model with (<code>Code 3.4</code>) and print the R output (<code>Code 3.5</code>). Read carefully the code annotation note in Code 3.4, which describes the R syntax for writing a model.</p>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.4 Simple linear model</summary>
<div class="sourceCode cell-code" id="annotated-cell-5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-1" class="code-annotation-target"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(age <span class="sc">~</span> percentage.black, <span class="at">data =</span> lion_noses,</span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_intercept =</span> <span class="cn">NULL</span>, <span class="at">prior =</span> <span class="cn">NULL</span>, <span class="at">prior_aux =</span> <span class="cn">NULL</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="1,2" data-code-annotation="1">This is our first specification of a model in R, so worth looking at in detail, as most R modelling code is similar. The function <code>stan_glm</code> names the inferential method, in this case Bayesian inference from the <code>rstnarm</code> package. The tilde <code>~</code> separates the left and right sides of the equation. To the left is the outcome (age) and to the right the predictors, in this case just percentage.black. The data to be used is specified, usually from the name of a file loaded into the R Studio environment. There may then be extra <strong><em>arguments</em></strong>, in this example specifying the priors to make the Bayesian model identical to a classical model. The assigment symbol <code>&lt;-</code> saves the output of the model as an object <code>m1</code> which is visible in the R Studio environment.</span>
</dd>
</dl>
</div>
</div>
<p>some text</p>
<div class="cell">
<details class="code-fold">
<summary>Output from r packages broom.mixed and flextable</summary>
<div class="sourceCode cell-code" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>m1_table <span class="ot">&lt;-</span> broom.mixed<span class="sc">::</span><span class="fu">tidy</span>(m1, <span class="at">effects =</span> <span class="fu">c</span>(<span class="st">"fixed"</span>, <span class="st">"aux"</span>), </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>m1_table <span class="ot">&lt;-</span> m1_table <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ft1 <span class="ot">&lt;-</span> <span class="fu">flextable</span>(m1_table) <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_vanilla</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colformat_double</span>(<span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                     ) <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_header_labels</span>(<span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">term  =</span> <span class="st">"parameters"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.low =</span> <span class="st">"5%"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.high =</span> <span class="st">"95%"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">add_header_row</span>(<span class="at">colwidths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"90% CIs"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>ft1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-75fb2732{}.cl-75f09632{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-75f09646{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-75f50e24{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-75f53caa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-75f53cb4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-75f53cbe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-75f53cbf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-75fb2732"><thead><tr style="overflow-wrap:break-word;"><th colspan="3" class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632"></span></p></th><th colspan="2" class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">90% CIs</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">parameters</span></p></th><th class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">estimate</span></p></th><th class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">std.error</span></p></th><th class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">5%</span></p></th><th class="cl-75f53caa"><p class="cl-75f50e24"><span class="cl-75f09632">95%</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-75f53cb4"><p class="cl-75f50e24"><span class="cl-75f09646">(Intercept)</span></p></td><td class="cl-75f53cb4"><p class="cl-75f50e24"><span class="cl-75f09646">0.87</span></p></td><td class="cl-75f53cb4"><p class="cl-75f50e24"><span class="cl-75f09646">0.59</span></p></td><td class="cl-75f53cb4"><p class="cl-75f50e24"><span class="cl-75f09646">-0.12</span></p></td><td class="cl-75f53cb4"><p class="cl-75f50e24"><span class="cl-75f09646">1.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-75f53cbe"><p class="cl-75f50e24"><span class="cl-75f09646">percentage.black</span></p></td><td class="cl-75f53cbe"><p class="cl-75f50e24"><span class="cl-75f09646">0.11</span></p></td><td class="cl-75f53cbe"><p class="cl-75f50e24"><span class="cl-75f09646">0.02</span></p></td><td class="cl-75f53cbe"><p class="cl-75f50e24"><span class="cl-75f09646">0.08</span></p></td><td class="cl-75f53cbe"><p class="cl-75f50e24"><span class="cl-75f09646">0.13</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-75f53cbf"><p class="cl-75f50e24"><span class="cl-75f09646">sigma</span></p></td><td class="cl-75f53cbf"><p class="cl-75f50e24"><span class="cl-75f09646">1.72</span></p></td><td class="cl-75f53cbf"><p class="cl-75f50e24"><span class="cl-75f09646">0.24</span></p></td><td class="cl-75f53cbf"><p class="cl-75f50e24"><span class="cl-75f09646">1.40</span></p></td><td class="cl-75f53cbf"><p class="cl-75f50e24"><span class="cl-75f09646">2.19</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="modelling-process-following-ros-chs-6-9" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="modelling-process-following-ros-chs-6-9"><span class="header-section-number">4</span> Modelling process (following ROS chs 6-9)</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ROS Ch 6 summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>At a purely mathematical level, the methods described in this book have two purposes: prediction and comparison. We can use regression to predict an outcome variable, or more precisely the distribution of the outcome, given some set of inputs. And we can compare these predictions for different values of the inputs, to make simple comparisons between groups, or to estimate causal effects, a topic to which we shall return in Chapters 18–21. In this chapter we use our favoured technique of fake-data simulation to understand a simple regression model, use a real-data example of height and earnings to warn against unwarranted causal interpretations, and discuss the historical origins of regression as it relates to comparisons and statistical adjustment.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ROS Ch 7 summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>As discussed in Chapter 1, regression is fundamentally a technology for predicting an outcome y from inputs x 1, x 2, . . . . In this chapter we introduce regression in the simple (but not trivial) case of a linear model predicting a continuous y from a single continuous x, thus fitting the model yi = a + bx i + error to data (x i, yi ), i = 1, . . . , n.&nbsp;We demonstrate with an applied example that includes the steps of fitting the model, displaying the data and fitted line, and interpreting the fit. We then show how to check the fitting procedure using fake-data simulation, and the chapter concludes with an explanation of how linear regression includes simple comparison as a special case.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ros Ch8 summary
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Most of this book is devoted to examples and tools for the practical use and understanding of regression models, starting with linear regression with a single predictor and moving to multiple predictors, nonlinear models, and applications in prediction and causal inference. In this chapter we lay out some of the mathematical structure of inference for regression models and some algebra to help understand estimation for linear regression. We also explain the rationale for the use of the Bayesian fitting routine <code>stan_glm</code> and its connection to classical linear regression. This chapter thus provides background and motivation for the mathematical and computational tools used in the rest of the book.</p>
</div>
</div>
</div>
<p>Chapter 7 sequence</p>
<ul>
<li>read in the data, having tidied first if necessary
<ul>
<li>made easy on this occasion as the data is in an R package and is tidy (one row per observation, one column per variable)</li>
</ul></li>
<li>define your model
<ul>
<li>For the first and simplest model (m1) assume there is a straight line relation between the outcome (age) and the predictor (nose markings), though with uncertainty (“error”) due to one or all of sampling error, measurement error and model error. Our model is therefore the straight line equation ‘y = a + bx’ plus error, where a is the intercept (where the line meets the y axis) and x is the slope. So, <code>age = a + b*percentage.black + error</code><br>
</li>
</ul></li>
<li>convert the model into R code
<ul>
<li>There are several inference machines in statistics, all available in R. We’ll use Bayesian inference via the user-friendly <code>rstanarm</code> package, but regularly cross-reference examples to classical inference implements with the <code>lm</code> function of R’s base package <code>stats</code>. With rstanarm our first line of code is <code>m1 &lt;- stan_glm(age ~ percentage.black,</code> <code>data = lion_noses)</code> see <code>Code 3.4</code> for more explanation <strong><em>Note</em></strong> To make rstanarm produce same as <code>lm</code> the code is <code>stan_glm(age ~ percentage.black, data=</code> <code>lion_noses, prior_intercept=NULL, prior=NULL,</code> <code>prior_aux=NULL, algorithm="optimizing")</code></li>
</ul></li>
<li>run your model and look at the results
<ul>
<li>either print as in code 3.5 or use the <code>modelsummary</code> package</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(m1, <span class="at">gof_map =</span> <span class="cn">NA</span>, <span class="at">statistic =</span> <span class="st">'conf.int'</span>, <span class="at">conf_level =</span> <span class="fl">0.9</span>, <span class="at">shape =</span> term <span class="sc">~</span> model <span class="sc">+</span> statistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_49spw23826e3r4pna06f(i, j, css_id) {
          var table = document.getElementById("tinytable_49spw23826e3r4pna06f");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_49spw23826e3r4pna06f');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_49spw23826e3r4pna06f(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_49spw23826e3r4pna06f");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_y40aj94frdywnmju3x0f',}, 
          { positions: [ { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_x3lpfbgzed5qi2xfpmgn',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_q4k8rory660qd0300zb0',}, 
          { positions: [ { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 3 },  ], css_id: 'tinytable_css_k8qe7kuvtbo1httf66pc',}, 
          { positions: [ { i: 3, j: 0 },  ], css_id: 'tinytable_css_iwhu8plps90aripxf14t',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_gy06buwzspnvztk45lil',}, 
          { positions: [ { i: 2, j: 0 },  ], css_id: 'tinytable_css_9h3dxkc1hdddjtcvua6e',}, 
          { positions: [ { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_8sbr7dqmk2n1546jv4ro',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_57v9jcwefau5kh383th3',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_49spw23826e3r4pna06f(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_y40aj94frdywnmju3x0f, .table th.tinytable_css_y40aj94frdywnmju3x0f { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_x3lpfbgzed5qi2xfpmgn, .table th.tinytable_css_x3lpfbgzed5qi2xfpmgn { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_q4k8rory660qd0300zb0, .table th.tinytable_css_q4k8rory660qd0300zb0 { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_k8qe7kuvtbo1httf66pc, .table th.tinytable_css_k8qe7kuvtbo1httf66pc { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_iwhu8plps90aripxf14t, .table th.tinytable_css_iwhu8plps90aripxf14t { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_gy06buwzspnvztk45lil, .table th.tinytable_css_gy06buwzspnvztk45lil { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_9h3dxkc1hdddjtcvua6e, .table th.tinytable_css_9h3dxkc1hdddjtcvua6e { text-align: left; }
      .table td.tinytable_css_8sbr7dqmk2n1546jv4ro, .table th.tinytable_css_8sbr7dqmk2n1546jv4ro { text-align: center; }
      .table td.tinytable_css_57v9jcwefau5kh383th3, .table th.tinytable_css_57v9jcwefau5kh383th3 { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_49spw23826e3r4pna06f" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">(1)</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">5.0 %</th>
                <th scope="col">95.0 %</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.866</td>
                  <td>-0.119</td>
                  <td>1.907</td>
                </tr>
                <tr>
                  <td>percentage.black</td>
                  <td>0.107</td>
                  <td>0.079</td>
                  <td>0.133</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<table class="table-striped table-hover caption-top table">
<caption>parameters</caption>
<thead>
<tr class="header">
<th>parameter</th>
<th>estimate</th>
<th>uncertainty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a</td>
<td>0.872</td>
<td>0.603</td>
</tr>
<tr class="even">
<td>b</td>
<td>0.107</td>
<td>0.016</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma\)</span></td>
<td>1.713</td>
<td>0.227</td>
</tr>
</tbody>
</table>
<p>These can also be calculated “by hand” from the posterior simulations</p>
<div class="cell">
<details class="code-fold">
<summary>parameters and uncertainty from model matrix (use array?) of posterior simulations</summary>
<div class="sourceCode cell-code" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(m1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>estimate_a <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">median</span>(sims[,<span class="dv">1</span>]),<span class="dv">3</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>estimate_b <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">median</span>(sims[,<span class="dv">2</span>]),<span class="dv">3</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>estimate_c <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">median</span>(sims[,<span class="dv">3</span>]),<span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ci_a <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">quantile</span>(sims[,<span class="dv">1</span>], <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>),<span class="dv">3</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ci_b <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">quantile</span>(sims[,<span class="dv">2</span>], <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>),<span class="dv">3</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">printL</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">"the estimated intercept is"</span> <span class="ot">=</span> estimate_a,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">"the estimated slope is"</span><span class="ot">=</span>estimate_b,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">"the estimated residual standard deviation is"</span><span class="ot">=</span>estimate_c,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">"the intercept cis are"</span><span class="ot">=</span>ci_a,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">"the slope cis are"</span><span class="ot">=</span>ci_b</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>the estimated intercept is: 0.866

the estimated slope is: 0.107

the estimated residual standard deviation is: 1.716

the intercept cis are:
 2.5% 97.5% 
    0     2 

the slope cis are:
 2.5% 97.5% 
    0     0 </code></pre>
</div>
</div>
<p>So the result for <span class="math inline">\(\sigma\)</span> the residual standard deviation means that age will be within +/- 2*1.7 = +/-3.4 years 95% of the time.</p>
<p>The R<sup>2</sup> is given by <code>R2 &lt;- 1 - sigma(m1)^2 / sd(lion_noses$age)^2</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> <span class="fu">sigma</span>(m1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sd</span>(lion_noses<span class="sc">$</span>age)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.5888428</code></pre>
</div>
</div>
<p>So almost 60% of the variance in age can be explained by nose markings. Where is the other 40%? Probably in other variables (lion health?) the model did not include.</p>
<div class="cell" data-code-block-bg="true" data-highlight-style="github" data-source-line-numbers="1" data-output-line-numbers="7-9,12-13">
<details class="code-fold">
<summary>Code 3.5 model 1 output</summary>
<div class="sourceCode cell-code" id="cb8" data-source-line-numbers="1" data-code-line-numbers="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m1, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb9" data-output-line-numbers="7-9,12-13" data-code-line-numbers="7-9,12-13"><pre class="sourceCode numberSource highlight numberLines code-with-copy"><code class="sourceCode"><span id="cb9-1"><a href="#cb9-1"></a>stan_glm</span>
<span id="cb9-2"><a href="#cb9-2"></a> family:       gaussian [identity]</span>
<span id="cb9-3"><a href="#cb9-3"></a> formula:      age ~ percentage.black</span>
<span id="cb9-4"><a href="#cb9-4"></a> observations: 32</span>
<span id="cb9-5"><a href="#cb9-5"></a> predictors:   2</span>
<span id="cb9-6"><a href="#cb9-6"></a>------</span>
<span id="cb9-7"><a href="#cb9-7"></a>                 Median MAD_SD</span>
<span id="cb9-8"><a href="#cb9-8"></a>(Intercept)      0.866  0.589 </span>
<span id="cb9-9"><a href="#cb9-9"></a>percentage.black 0.107  0.016 </span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a>Auxiliary parameter(s):</span>
<span id="cb9-12"><a href="#cb9-12"></a>      Median MAD_SD</span>
<span id="cb9-13"><a href="#cb9-13"></a>sigma 1.716  0.228 </span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a>------</span>
<span id="cb9-16"><a href="#cb9-16"></a>* For help interpreting the printed output see ?print.stanreg</span>
<span id="cb9-17"><a href="#cb9-17"></a>* For info on the priors used see ?prior_summary.stanreg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-code-block-bg="true" data-highlight-style="github" data-source-line-numbers="1" data-output-line-numbers="13-16">
<details class="code-fold">
<summary>Code 3.6 model 1 summary</summary>
<div class="sourceCode cell-code" id="cb10" data-source-line-numbers="1" data-code-line-numbers="1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb11" data-output-line-numbers="13-16" data-code-line-numbers="13-16"><pre class="sourceCode numberSource highlight numberLines code-with-copy"><code class="sourceCode"><span id="cb11-1"><a href="#cb11-1"></a></span>
<span id="cb11-2"><a href="#cb11-2"></a>Model Info:</span>
<span id="cb11-3"><a href="#cb11-3"></a> function:     stan_glm</span>
<span id="cb11-4"><a href="#cb11-4"></a> family:       gaussian [identity]</span>
<span id="cb11-5"><a href="#cb11-5"></a> formula:      age ~ percentage.black</span>
<span id="cb11-6"><a href="#cb11-6"></a> algorithm:    sampling</span>
<span id="cb11-7"><a href="#cb11-7"></a> sample:       4000 (posterior sample size)</span>
<span id="cb11-8"><a href="#cb11-8"></a> priors:       see help('prior_summary')</span>
<span id="cb11-9"><a href="#cb11-9"></a> observations: 32</span>
<span id="cb11-10"><a href="#cb11-10"></a> predictors:   2</span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a>Estimates:</span>
<span id="cb11-13"><a href="#cb11-13"></a>                   mean   sd    10%   50%   90%</span>
<span id="cb11-14"><a href="#cb11-14"></a>(Intercept)      0.882  0.610 0.124 0.866 1.664</span>
<span id="cb11-15"><a href="#cb11-15"></a>percentage.black 0.106  0.016 0.086 0.107 0.127</span>
<span id="cb11-16"><a href="#cb11-16"></a>sigma            1.744  0.243 1.464 1.716 2.050</span>
<span id="cb11-17"><a href="#cb11-17"></a></span>
<span id="cb11-18"><a href="#cb11-18"></a>Fit Diagnostics:</span>
<span id="cb11-19"><a href="#cb11-19"></a>           mean   sd    10%   50%   90%</span>
<span id="cb11-20"><a href="#cb11-20"></a>mean_PPD 4.304  0.443 3.750 4.303 4.866</span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a>The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).</span>
<span id="cb11-23"><a href="#cb11-23"></a></span>
<span id="cb11-24"><a href="#cb11-24"></a>MCMC diagnostics</span>
<span id="cb11-25"><a href="#cb11-25"></a>                 mcse  Rhat  n_eff</span>
<span id="cb11-26"><a href="#cb11-26"></a>(Intercept)      0.010 1.001 3433 </span>
<span id="cb11-27"><a href="#cb11-27"></a>percentage.black 0.000 1.001 3449 </span>
<span id="cb11-28"><a href="#cb11-28"></a>sigma            0.004 1.000 3086 </span>
<span id="cb11-29"><a href="#cb11-29"></a>mean_PPD         0.007 1.000 3836 </span>
<span id="cb11-30"><a href="#cb11-30"></a>log-posterior    0.035 1.002 1521 </span>
<span id="cb11-31"><a href="#cb11-31"></a></span>
<span id="cb11-32"><a href="#cb11-32"></a>For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>When the model m1 is run, a large amount of information is saved into m1, now visible in the R Studio environment. The essentials for interpreting the model are shown above, with the <code>print(m1)</code> command, but we could also look at any of the 27 stored objects individually, most of which we will not use, for example the coefficients (lines 8-9 above, hover over the code output) with <code>m1$coefficients</code>, which gives the same information as the Median column in the summary, although to more decimal places. This option to look more carefully at the output, rather than be presented with just a summary, is distinctive to R and other coding softwares.</p>
<p>The output is telling us (lines 7-9 highlighted), for now ignoring statistical uncertainty, that the best fit to the proposed model <code>y = intercept + slope*percentage.black + error</code> is:</p>
<p style="text-align: center;">
<b>age = 0.9 + 0.1*percentage.black</b>
</p>
<p>Let’s plot this line and the data.</p>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.6 A plot of the simple linear regression for model 1</summary>
<div class="sourceCode cell-code" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lion_noses, <span class="fu">aes</span>(percentage.black, age)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">0.9</span>, <span class="at">slope =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"percentage black on nose"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"age (years)"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">26</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">5</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"y = 0.9 + 0.1x"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(x,y, <span class="at">label =</span> label),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s plug some numbers into the equation. Three lions L1, L2 and L3 are photographed in the field and subsequent investigation of the image estimates 42%, 50% and 60% nose markings. Using R as a pocket calculator, L1’s estimated age is given by the R code <code>0.9 + 0.1*42</code> = 5.1 years, L2’s <code>0.9 + 0.1*50</code> = 5.9 years and L3’s <code>0.9 + 0.1*60</code> = 6.9 years. As our model is a monotonic line (no curves), change in y as determined by the slope is constant and the general result is that;</p>
<p><strong>A 10% increase in nose markings equates to a 1 year increase in age</strong>.</p>
<p><strong>A safe interpretation is that, under model assumptions, the average difference in age, comparing two lions 10% different in nose markings, is one year. The safest interpretation of a regression is as a comparison</strong>. a nod towards effects and causal inference.</p>
<p>To summarize: regression is a mathematical tool for making predictions. Regression coefficients can sometimes be interpreted as effects, but they can always be interpreted as average comparisons.</p>
<p>If our model is correct, which we shall need to check, it is a better method of selecting which lions to hunt for trophies than the ad-hoc model, which assumed a lion with 40% nose markings was under 5 years. L1 met that threshold, but only just. If our measurer had been in a hurry and making small mistakes, whereas the actual measure was 40%, L1’s age should have been modelled as <code>0.9 +0.1*40</code> = 4.9 years and he could have not been made available to trophy hunters. CHECK THIS</p>
<p>The standard error for the slope (MAD_SD on line 9 of the model output <code>Code 3.5</code>) is 0.015, so the model has a slope of, to two decimal places, 0.11 +/- 0.01 and the 95% interval</p>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.7 Print the Confidence Intervals for model 1</summary>
<div class="sourceCode cell-code" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">posterior_interval</span>(m1, <span class="at">prob =</span> <span class="fl">0.9</span>), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                    5%  95%
(Intercept)      -0.12 1.91
percentage.black  0.08 0.13
sigma             1.40 2.19</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ROS Ch 9
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Bayesian inference involves three steps that go beyond classical estimation. First, the data and model are combined to form a posterior distribution, which we typically summarize by a set of simulations of the parameters in the model. Second, we can propagate uncertainty in this distribution—that is, we can get simulation-based predictions for unobserved or future outcomes that accounts for uncertainty in the model parameters. Third, we can include additional information into the model using a prior distribution. The present chapter describes all three of these steps in the context of examples capturing challenges of prediction and inference.</p>
</div>
</div>
</div>
<p>For now we’ll not worry about priors and use defaults as per <em>Bayes Rules!</em>, complicated and we have no prior information to feed into the model, but concentrate on the posterior simulations to get estimates.</p>
<p>After fitting a regression, y = a + bx + error, we can use it to predict a new data point, or a set of new data points, with predictors x new . We can make three sorts of predictions, corresponding to increasing levels of uncertainty:</p>
<ol type="1">
<li><p>The <strong><em>point prediction</em></strong>, <span class="math inline">\(\hat{a}\)</span> + <span class="math inline">\(\hat{b}\)</span>x new : Based on the fitted model, this is the best point estimate of the average value of y for new data points with this new value of x. We use <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{b}\)</span> here because the point prediction ignores uncertainty.</p></li>
<li><p>The <strong><em>linear predictor</em></strong> with uncertainty, a + bx new , propagating the inferential uncertainty in (a, b). This represents the distribution of uncertainty about the expected or average value of y for new data points with predictors x new .</p></li>
<li><p>The <strong><em>predictive distribution for a new observation</em></strong>, a + bx new + error: This represents uncertainty about a new observation y with predictors x new .</p></li>
</ol>
<p>Consider our study, with y (age) predicted from x (nose markings).</p>
<!-- 1. For any given x new , the point prediction is the best estimate of the lion's age in the population, conditional on mose markings x new.  -->
<ol start="2" type="1">
<li><p>The linear predictor is the modeled average age of lions with nose marking x new in the population, with uncertainty corresponding to inferential uncertainty in the coefficients a and b.</p></li>
<li><p>The predictive distribution represents the age of a single lion drawn at random from this population, under the model conditional on the specified value of x new .</p></li>
</ol>
<p>As sample size approaches infinity, the coefficients a and b are estimated more and more precisely, and the uncertainty in the linear predictor approaches zero, but the uncertainty in the predictive distribution for a new observation does not approach zero; it approaches the residual standard deviation <span class="math inline">\(\sigma\)</span> (sigma in Table 1).</p>
<p>Consider a lion on territory, so it can be re-found for trophy hunting, which is photographed and the nose markings measured as 45%. Let’s calculate the three measures for this individual.</p>
<section id="point-estimate" class="level4">
<h4 class="anchored" data-anchor-id="point-estimate">Point estimate</h4>
<p>The point estimate where the best fit regression line can be approximately read off the graph <code>Code 3.6</code> as the value of y where x = 45. It is calculated with the base r function <code>predict</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">percentage.black=</span><span class="dv">45</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y_point_pred <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">predict</span>(m1, <span class="at">newdata=</span>new), <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The point prediction of the average age in years of a lion with </span><span class="sc">\n</span><span class="st">45% nose markings is"</span>, y_point_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>The point prediction of the average age in years of a lion with 
45% nose markings is 5.7</code></pre>
</div>
</div>
</section>
<section id="linear-predictor" class="level4">
<h4 class="anchored" data-anchor-id="linear-predictor">Linear predictor</h4>
<p>To put uncertainty intervals around the point estimate, the rstanarm function <code>posterior_linpred</code> is used</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y_linpred <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">posterior_linpred</span>(m1, <span class="at">newdata=</span>new), <span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ci_b <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y_linpred, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The linear predictor of the average age in years </span><span class="sc">\n</span><span class="st">of a lion with 45% nose markings are given by the </span><span class="sc">\n</span><span class="st">90% uncertainty intervals"</span>, ci_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>The linear predictor of the average age in years 
of a lion with 45% nose markings are given by the 
90% uncertainty intervals 5.04 6.27</code></pre>
</div>
</div>
</section>
<section id="predictive-uncertainty" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="predictive-uncertainty">Predictive uncertainty</h4>
<p>This uses the rstanarm function <code>posterior_predict</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(m1, <span class="at">newdata=</span>new)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Median <span class="ot">&lt;-</span> <span class="fu">median</span>(y_pred)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>MAD_SD <span class="ot">&lt;-</span> <span class="fu">mad</span>(y_pred)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>young <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_pred <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>uncertainty_90 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y_pred, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">printL</span>(<span class="st">"The predicted age of a lion with 45% nose markings is"</span><span class="ot">=</span><span class="fu">round</span>(Median,<span class="dv">1</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"with uncertainty intervals"</span><span class="ot">=</span><span class="fu">round</span>(uncertainty_90, <span class="dv">1</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"The probability that a lion with 45% nose marking is under </span><span class="sc">\n</span><span class="st">5 years' age is"</span> <span class="ot">=</span><span class="fu">round</span>(young, <span class="dv">2</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>The predicted age of a lion with 45% nose markings is: 5.7

with uncertainty intervals:
 5% 95% 
2.7 8.5 

The probability that a lion with 45% nose marking is under 
5 years' age is: 0.34</code></pre>
</div>
</div>
<p>It is also possible to calculate any of these three over a range of values. Let’s do that for the range of nose markings for which we have data (a rule of thumb to not predict outside of the data range) so between 10-80% and at 5% intervals</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>new_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">percentage.black=</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">5</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>y_point_pred_grid <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, <span class="at">newdata=</span>new_grid)<span class="co"># 15 values</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>y_point_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y_point_pred_grid)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>y_linpred_grid <span class="ot">&lt;-</span> <span class="fu">posterior_linpred</span>(m1, <span class="at">newdata=</span>new_grid) <span class="co"># 4000 sims for each of 15 values</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>y_linpred_cis <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y_linpred_grid) </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>y_pred_grid <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(m1, <span class="at">newdata=</span>new_grid) <span class="co"># 4000 sims for each of 15 values</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>y_pred_cis <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y_pred_grid)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>quants <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>linear_uncertainty <span class="ot">&lt;-</span> <span class="fu">apply</span>( y_linpred_cis[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] , <span class="dv">2</span> , quantile , <span class="at">probs =</span> quants , <span class="at">na.rm =</span> <span class="cn">TRUE</span> )</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>prediction_uncertainty <span class="ot">&lt;-</span> <span class="fu">apply</span>( y_pred_cis[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>] , <span class="dv">2</span> , quantile , <span class="at">probs =</span> quants , <span class="at">na.rm =</span> <span class="cn">TRUE</span> )</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>linear_uncertainty_t <span class="ot">&lt;-</span> <span class="fu">t</span>(linear_uncertainty)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>prediction_uncertainty_t <span class="ot">&lt;-</span> <span class="fu">t</span>(prediction_uncertainty)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">5</span>))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>m1_estimates <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>( intervals, y_point_pred_df, linear_uncertainty_t, prediction_uncertainty_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre data-code-line-numbers=""><code>New names:
• `5%` -&gt; `5%...3`
• `95%` -&gt; `95%...4`
• `5%` -&gt; `5%...5`
• `95%` -&gt; `95%...6`</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to complete</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="ot">&lt;-</span> <span class="fu">gt</span>(m1_estimates)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimates of point, point uncertainty and prediction uncertainty for lion age from nose markings"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Estimates at 5% intervals for nose markings over the range of the sample data"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimals =</span> <span class="dv">1</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"seq(10, 80, 5)"</span> <span class="ot">=</span> <span class="st">"Nose markings (percent)"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_point_pred_grid =</span> <span class="st">"point prediction of mean age (years)"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5%...3"</span> <span class="ot">=</span> <span class="st">"5%"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95%...4"</span> <span class="ot">=</span> <span class="st">"95%"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5%...5"</span> <span class="ot">=</span> <span class="st">"5%"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95%...6"</span> <span class="ot">=</span> <span class="st">"95%"</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"uncertainty intervals for mean age"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"uncertainty intervals for individual age prediction"</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="bjtazditfn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bjtazditfn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bjtazditfn thead, #bjtazditfn tbody, #bjtazditfn tfoot, #bjtazditfn tr, #bjtazditfn td, #bjtazditfn th {
  border-style: none;
}

#bjtazditfn p {
  margin: 0;
  padding: 0;
}

#bjtazditfn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bjtazditfn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bjtazditfn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bjtazditfn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bjtazditfn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjtazditfn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjtazditfn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bjtazditfn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bjtazditfn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bjtazditfn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bjtazditfn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bjtazditfn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bjtazditfn .gt_spanner_row {
  border-bottom-style: hidden;
}

#bjtazditfn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bjtazditfn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bjtazditfn .gt_from_md > :first-child {
  margin-top: 0;
}

#bjtazditfn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bjtazditfn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bjtazditfn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bjtazditfn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bjtazditfn .gt_row_group_first td {
  border-top-width: 2px;
}

#bjtazditfn .gt_row_group_first th {
  border-top-width: 2px;
}

#bjtazditfn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjtazditfn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bjtazditfn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bjtazditfn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjtazditfn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjtazditfn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bjtazditfn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bjtazditfn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bjtazditfn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bjtazditfn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjtazditfn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjtazditfn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bjtazditfn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bjtazditfn .gt_left {
  text-align: left;
}

#bjtazditfn .gt_center {
  text-align: center;
}

#bjtazditfn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bjtazditfn .gt_font_normal {
  font-weight: normal;
}

#bjtazditfn .gt_font_bold {
  font-weight: bold;
}

#bjtazditfn .gt_font_italic {
  font-style: italic;
}

#bjtazditfn .gt_super {
  font-size: 65%;
}

#bjtazditfn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bjtazditfn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bjtazditfn .gt_indent_1 {
  text-indent: 5px;
}

#bjtazditfn .gt_indent_2 {
  text-indent: 10px;
}

#bjtazditfn .gt_indent_3 {
  text-indent: 15px;
}

#bjtazditfn .gt_indent_4 {
  text-indent: 20px;
}

#bjtazditfn .gt_indent_5 {
  text-indent: 25px;
}

#bjtazditfn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bjtazditfn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal">Estimates of point, point uncertainty and prediction uncertainty for lion age from nose markings</th>
</tr>
<tr class="odd gt_heading">
<th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Estimates at 5% intervals for nose markings over the range of the sample data</th>
</tr>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="seq(10,-80,-5)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Nose markings (percent)</th>
<th rowspan="2" id="y_point_pred_grid" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">point prediction of mean age (years)</th>
<th colspan="2" id="uncertainty intervals for mean age" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
uncertainty intervals for mean age
</div></th>
<th colspan="2" id="uncertainty intervals for individual age prediction" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
uncertainty intervals for individual age prediction
</div></th>
</tr>
<tr class="odd gt_col_headings">
<th id="a5%...3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">5%</th>
<th id="a95%...4" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95%</th>
<th id="a5%...5" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">5%</th>
<th id="a95%...6" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95%</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">10.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">1.9</td>
<td class="gt_row gt_center" headers="5%...3">1.2</td>
<td class="gt_row gt_center" headers="95%...4">2.7</td>
<td class="gt_row gt_center" headers="5%...5">−1.1</td>
<td class="gt_row gt_center" headers="95%...6">4.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">15.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">2.5</td>
<td class="gt_row gt_center" headers="5%...3">1.8</td>
<td class="gt_row gt_center" headers="95%...4">3.2</td>
<td class="gt_row gt_center" headers="5%...5">−0.5</td>
<td class="gt_row gt_center" headers="95%...6">5.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">20.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">3.0</td>
<td class="gt_row gt_center" headers="5%...3">2.4</td>
<td class="gt_row gt_center" headers="95%...4">3.6</td>
<td class="gt_row gt_center" headers="5%...5">0.0</td>
<td class="gt_row gt_center" headers="95%...6">5.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">25.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">3.5</td>
<td class="gt_row gt_center" headers="5%...3">3.0</td>
<td class="gt_row gt_center" headers="95%...4">4.1</td>
<td class="gt_row gt_center" headers="5%...5">0.6</td>
<td class="gt_row gt_center" headers="95%...6">6.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">30.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">4.1</td>
<td class="gt_row gt_center" headers="5%...3">3.6</td>
<td class="gt_row gt_center" headers="95%...4">4.6</td>
<td class="gt_row gt_center" headers="5%...5">1.1</td>
<td class="gt_row gt_center" headers="95%...6">7.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">35.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">4.6</td>
<td class="gt_row gt_center" headers="5%...3">4.1</td>
<td class="gt_row gt_center" headers="95%...4">5.1</td>
<td class="gt_row gt_center" headers="5%...5">1.7</td>
<td class="gt_row gt_center" headers="95%...6">7.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">40.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">5.1</td>
<td class="gt_row gt_center" headers="5%...3">4.6</td>
<td class="gt_row gt_center" headers="95%...4">5.7</td>
<td class="gt_row gt_center" headers="5%...5">2.1</td>
<td class="gt_row gt_center" headers="95%...6">8.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">45.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">5.7</td>
<td class="gt_row gt_center" headers="5%...3">5.0</td>
<td class="gt_row gt_center" headers="95%...4">6.3</td>
<td class="gt_row gt_center" headers="5%...5">2.7</td>
<td class="gt_row gt_center" headers="95%...6">8.7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">50.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">6.2</td>
<td class="gt_row gt_center" headers="5%...3">5.5</td>
<td class="gt_row gt_center" headers="95%...4">6.9</td>
<td class="gt_row gt_center" headers="5%...5">3.2</td>
<td class="gt_row gt_center" headers="95%...6">9.1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">55.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">6.7</td>
<td class="gt_row gt_center" headers="5%...3">5.9</td>
<td class="gt_row gt_center" headers="95%...4">7.5</td>
<td class="gt_row gt_center" headers="5%...5">3.7</td>
<td class="gt_row gt_center" headers="95%...6">9.7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">60.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">7.3</td>
<td class="gt_row gt_center" headers="5%...3">6.4</td>
<td class="gt_row gt_center" headers="95%...4">8.1</td>
<td class="gt_row gt_center" headers="5%...5">4.3</td>
<td class="gt_row gt_center" headers="95%...6">10.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">65.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">7.8</td>
<td class="gt_row gt_center" headers="5%...3">6.8</td>
<td class="gt_row gt_center" headers="95%...4">8.8</td>
<td class="gt_row gt_center" headers="5%...5">4.7</td>
<td class="gt_row gt_center" headers="95%...6">10.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">70.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">8.3</td>
<td class="gt_row gt_center" headers="5%...3">7.2</td>
<td class="gt_row gt_center" headers="95%...4">9.4</td>
<td class="gt_row gt_center" headers="5%...5">5.2</td>
<td class="gt_row gt_center" headers="95%...6">11.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">75.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">8.9</td>
<td class="gt_row gt_center" headers="5%...3">7.6</td>
<td class="gt_row gt_center" headers="95%...4">10.1</td>
<td class="gt_row gt_center" headers="5%...5">5.8</td>
<td class="gt_row gt_center" headers="95%...6">12.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="seq(10, 80, 5)">80.0</td>
<td class="gt_row gt_center" headers="y_point_pred_grid">9.4</td>
<td class="gt_row gt_center" headers="5%...3">8.0</td>
<td class="gt_row gt_center" headers="95%...4">10.7</td>
<td class="gt_row gt_center" headers="5%...5">6.2</td>
<td class="gt_row gt_center" headers="95%...6">12.6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>estimates from simulation matrix</summary>
<div class="sourceCode cell-code" id="cb24" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(m1)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Median <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">apply</span>(sims, <span class="dv">2</span>, median),<span class="dv">3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>MAD_SD <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">apply</span>(sims, <span class="dv">2</span>, mad),<span class="dv">3</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(Median, MAD_SD))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                 Median MAD_SD
(Intercept)       0.866  0.589
percentage.black  0.107  0.016
sigma             1.716  0.228</code></pre>
</div>
</div>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.9 A comparison of classical and Bayesian models</summary>
<div class="sourceCode cell-code" id="cb26" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"OLS classical"</span> <span class="ot">=</span> <span class="fu">lm</span>(age <span class="sc">~</span> percentage.black, <span class="at">data =</span> lion_noses),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"OLS rstanarm default priors"</span> <span class="ot">=</span> <span class="fu">stan_glm</span>(age <span class="sc">~</span> percentage.black, <span class="at">data =</span> lion_noses),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"OLS rstnarm flat priors"</span> <span class="ot">=</span> <span class="fu">stan_glm</span>(age <span class="sc">~</span> percentage.black, <span class="at">data =</span> lion_noses, <span class="at">prior_intercept =</span> <span class="cn">NULL</span>, <span class="at">prior =</span> <span class="cn">NULL</span>, <span class="at">prior_aux =</span> <span class="cn">NULL</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-code-block-bg="true" data-highlight-style="github">
<details class="code-fold">
<summary>Code 3.10 A comparison of classical and Bayesian models</summary>
<div class="sourceCode cell-code" id="cb27" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(models, <span class="at">gof_map =</span> <span class="cn">NA</span>, <span class="at">statistic =</span> <span class="st">'conf.int'</span>, <span class="at">conf_level =</span> <span class="fl">0.95</span>, <span class="at">stars =</span> <span class="cn">TRUE</span>, <span class="at">shape =</span> term <span class="sc">~</span> model <span class="sc">+</span> statistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_flyxmp21ehcopbg4po0l(i, j, css_id) {
          var table = document.getElementById("tinytable_flyxmp21ehcopbg4po0l");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_flyxmp21ehcopbg4po0l');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_flyxmp21ehcopbg4po0l(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_flyxmp21ehcopbg4po0l");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 3, j: 0 },  ], css_id: 'tinytable_css_rkh2n6vpksfv15y2nss0',}, 
          { positions: [ { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 6 }, { i: 3, j: 3 }, { i: 3, j: 7 }, { i: 3, j: 4 }, { i: 3, j: 8 }, { i: 3, j: 5 }, { i: 3, j: 9 },  ], css_id: 'tinytable_css_qxbkzwu131kf6t540dbw',}, 
          { positions: [ { i: 0, j: 7 }, { i: 0, j: 4 }, { i: 0, j: 8 }, { i: 0, j: 5 }, { i: 0, j: 9 }, { i: 0, j: 6 },  ], css_id: 'tinytable_css_qgtzpqw0wk7k5uj9c8t0',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 8 }, { i: 1, j: 5 }, { i: 1, j: 2 }, { i: 1, j: 9 }, { i: 1, j: 6 }, { i: 1, j: 3 }, { i: 1, j: 7 }, { i: 1, j: 4 },  ], css_id: 'tinytable_css_m6xdzydhs6qum0rlnioi',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_hrt9pq86fz5bpd6bp78c',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_ellwi4u3a4hpc8ko2ruk',}, 
          { positions: [ { i: 2, j: 0 },  ], css_id: 'tinytable_css_5g7etpvmr9zgunwopix4',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_3vudirw3ll11eyc8jqa1',}, 
          { positions: [ { i: 2, j: 3 }, { i: 2, j: 7 }, { i: 2, j: 4 }, { i: 2, j: 1 }, { i: 2, j: 8 }, { i: 2, j: 5 }, { i: 2, j: 2 }, { i: 2, j: 9 }, { i: 2, j: 6 },  ], css_id: 'tinytable_css_0g5lezewnkp3fhbm14p8',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_flyxmp21ehcopbg4po0l(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_rkh2n6vpksfv15y2nss0, .table th.tinytable_css_rkh2n6vpksfv15y2nss0 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_qxbkzwu131kf6t540dbw, .table th.tinytable_css_qxbkzwu131kf6t540dbw { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_qgtzpqw0wk7k5uj9c8t0, .table th.tinytable_css_qgtzpqw0wk7k5uj9c8t0 { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_m6xdzydhs6qum0rlnioi, .table th.tinytable_css_m6xdzydhs6qum0rlnioi { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_hrt9pq86fz5bpd6bp78c, .table th.tinytable_css_hrt9pq86fz5bpd6bp78c { text-align: center; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_ellwi4u3a4hpc8ko2ruk, .table th.tinytable_css_ellwi4u3a4hpc8ko2ruk { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_5g7etpvmr9zgunwopix4, .table th.tinytable_css_5g7etpvmr9zgunwopix4 { text-align: left; }
      .table td.tinytable_css_3vudirw3ll11eyc8jqa1, .table th.tinytable_css_3vudirw3ll11eyc8jqa1 { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_0g5lezewnkp3fhbm14p8, .table th.tinytable_css_0g5lezewnkp3fhbm14p8 { text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_flyxmp21ehcopbg4po0l" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">OLS classical</th>
<th scope="col" align="center" colspan="3">OLS rstanarm default priors</th>
<th scope="col" align="center" colspan="3">OLS rstnarm flat priors</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
                <th scope="col">Est.</th>
                <th scope="col">2.5 %</th>
                <th scope="col">97.5 %</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="10">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.879</td>
                  <td>-0.283</td>
                  <td>2.041</td>
                  <td>0.864</td>
                  <td>-0.258</td>
                  <td>2.027</td>
                  <td>0.871</td>
                  <td>-0.305</td>
                  <td>2.102</td>
                </tr>
                <tr>
                  <td>percentage.black</td>
                  <td>0.106***</td>
                  <td>0.076</td>
                  <td>0.137</td>
                  <td>0.107</td>
                  <td>0.077</td>
                  <td>0.137</td>
                  <td>0.106</td>
                  <td>0.074</td>
                  <td>0.138</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that there are five types of callouts, including: <code>note</code>, <code>warning</code>, <code>important</code>, <code>tip</code>, and <code>caution</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip with Title
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is an example of a callout with a title.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code 3.11 Plot mean uncertainty</summary>
<div class="sourceCode cell-code" id="cb28" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lion_noses <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code 3.12 Plot individual uncertainty</summary>
<div class="sourceCode cell-code" id="cb29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>lion_noses <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_predicted_draws</span>(m1) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .prediction), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code 3.13 Plot mean and individual uncertainty combined</summary>
<div class="sourceCode cell-code" id="cb30" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> lion_noses <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(m1) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> lion_noses <span class="sc">|&gt;</span>     </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_predicted_draws</span>(m1) <span class="sc">|&gt;</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .prediction), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>()</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> lion_noses <span class="sc">|&gt;</span> </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(m1)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> lion_noses <span class="sc">|&gt;</span> </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_predicted_draws</span>(m1)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(p3, p4)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>p5 <span class="sc">|&gt;</span> </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.95</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>) <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .prediction), <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"#08519C"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code 3.14 Plot mean and individual uncertainty side by side</summary>
<div class="sourceCode cell-code" id="cb31" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img column-screen-inset-shaded" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="bayes-rules-modelling-sequence-from-chapter-9" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="bayes-rules-modelling-sequence-from-chapter-9"><span class="header-section-number">5</span> Bayes Rules modelling sequence; from Chapter 9</h2>
<section id="specify-the-data-model" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="specify-the-data-model"><span class="header-section-number">5.1</span> specify the data model</h3>
<p>equation. Maths is shorthand, translate into english</p>
<p><span class="math inline">\(Y_i|\beta_0,\beta_1,\sigma\)</span> <span class="math inline">\(\simeq\)</span> <span class="math inline">\(N(\mu_1, \sigma^2)\)</span> with <span class="math inline">\(\mu_1 = \beta_0 +\beta_1X_1\)</span></p>
<ul>
<li>coefficients and parameters alternative names.</li>
<li>add fig 9.2 (simulate) to show how same parameters for slope and intercept ca arise with different sigmas.</li>
</ul>
</section>
<section id="specify-the-priors" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="specify-the-priors"><span class="header-section-number">5.2</span> Specify the priors</h3>
<p>Explain why defaults in rstnarm are ok</p>
</section>
<section id="posterior-simulation" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="posterior-simulation"><span class="header-section-number">5.3</span> Posterior simulation</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">neff_ratio</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     (Intercept) percentage.black            sigma 
         0.85825          0.86225          0.77150 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">rhat</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>     (Intercept) percentage.black            sigma 
       1.0010354        1.0006843        0.9996774 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(m1, <span class="at">size =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lion_noses <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_fitted_draws</span>(m1, <span class="at">n =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percentage.black, <span class="at">y =</span> age)) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .value, <span class="at">group =</span> .draw), <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> lion_noses, <span class="at">size =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre data-code-line-numbers=""><code>Warning in fitted_draws.default(model = model, newdata = newdata, ..., n = n): `fitted_draws` and `add_fitted_draws` are deprecated as their names were confusing.
- Use [add_]epred_draws() to get the expectation of the posterior predictive.
- Use [add_]linpred_draws() to get the distribution of the linear predictor.
- For example, you used [add_]fitted_draws(..., scale = "response"), which
  means you most likely want [add_]epred_draws(...).
NOTE: When updating to the new functions, note that the `model` parameter is now
  named `object` and the `n` parameter is now named `ndraws`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="present-conclusions" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="present-conclusions"><span class="header-section-number">6</span> Present conclusions</h2>
<p>yaba yaba</p>
</section>
<section id="interpret-in-subject-matter-terms" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="interpret-in-subject-matter-terms"><span class="header-section-number">7</span> Interpret in subject matter terms</h2>
<section id="shiny-app" class="level4">
<h4 class="anchored" data-anchor-id="shiny-app">Shiny app</h4>
<p>It is often useful in communicating your results to have an interactive app that can, in this case, allow someone to enter a nose marking measure and get output on the lion’s age with the model hidden. This has become increasingly easy in R with <a href="https://shiny.posit.co/">Shiny</a>. We’ll follow the official Shiny website and also a nice example on spatio-temporal data from <span class="citation" data-cites="Morega_2020">(<a href="#ref-Morega_2020" role="doc-biblioref">Morega 2020</a>)</span> which is <a href="https://www.paulamoraga.com/book-geospatial/">free online</a></p>
</section>
<section id="notes-on-stuff-to-addadded" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="notes-on-stuff-to-addadded"><span class="header-section-number">7.1</span> Notes on stuff to add/added</h3>
<p>added quarto <a href="https://github.com/shafayetShafee/line-highlight#line-highlight-extension-for-quarto">line-highlight</a> extension for highlighting code, including output code and <a href="https://github.com/quarto-ext/fontawesome">fontawesome</a> for icons</p>
<p>final section shiny app??</p>
<p>Check Paula Morega</p>
<p>add labels to code chunks <a href="https://github.com/kazuyanagimoto/quarto-awesomecv-typst">cv quarto template</a></p>
<p>add <a href="https://books.ropensci.org/targets/literate-programming.html">targets</a></p>
<p><a href="https://samanthacsik.github.io/posts/2022-10-24-quarto-blogs/">sam csik’s blog</a> article has instructions and code, how to add footnotes and a bibliography and citations and how to populate margins. Use these. also recommends <a href="https://www.w3schools.com/cssref/pr_font_weight.php">W3 schools for css/scss/html</a></p>
</section>
<section id="refs-and-open-books-to-add" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="refs-and-open-books-to-add"><span class="header-section-number">7.2</span> refs and open books to add</h3>
<p><a href="https://r4ds.hadley.nz/">R for Data Science 2e</a> and <a href="https://github.com/hadley/r4ds">source code on GitHub</a></p>
<p><a href="https://www.tmwr.org/">Tidy Modeling with R</a></p>
<p><a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html">R Markdown Cookbook online</a></p>
<p><a href="https://ggplot2-book.org/">ggplot2 3e online</a></p>
<p><a href="https://r-graphics.org/">R Graphics Cookbook online</a> ggplot2 based</p>
<p><a href="https://www.bayesrulesbook.com/">Bayes Rules! An Introduction to Applied Bayesian Modelling</a> uses rstanarm</p>
<p><a href="https://hbiostat.org/rflow/">Frank Harrell’s R workflow, inlcuding Quarto</a></p>
<p><a href="https://hbiostat.org/rmsc/">Harrell’s associated course</a></p>
<p><a href="https://www.andrewheiss.com/blog/2018/03/08/amelia-broom-huxtable/">huxtable for regression tables, Andrew Heiss’ blog</a></p>
<p><a href="https://hughjonesd.github.io/huxtable/huxtable.html">Huxtable R table package</a> recommended for regression tables</p>
<p><a href="https://patchwork.data-imaginist.com/articles/patchwork.html">patchwork r package</a> to reorganise image layout</p>
<p><a href="https://validator.w3.org/">html validator</a></p>
<p><a href="https://oeis.org/wiki/List_of_LaTeX_mathematical_symbols">LaTex symbols</a></p>
<p><a href="https://csgillespie.github.io/efficientR/">efficient R programming</a></p>
<p><a href="https://moderndive.com/index.html">modern dive</a></p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Alexander_2023" class="csl-entry" role="listitem">
Alexander, Rohan. 2023. <em>Telling Stories with Data with Applications in <span>R</span></em>. Chapman; Hall/CRC Press.
</div>
<div id="ref-Cox_Donnelly_2011" class="csl-entry" role="listitem">
Cox, D. R., and Christl A. Donnelly. 2011. <em>Principles of Applied Statistics</em>. Cambridge University Press.
</div>
<div id="ref-fieberg_2024" class="csl-entry" role="listitem">
Fieberg, John. 2024. <em>Statistics for Ecologists: A Frequentist and Bayesian Treatment of Modern Regression Models</em>. University of Minnesota Libraries Publishing. <a href="https://doi.org/10.24926/9781959870029">https://doi.org/10.24926/9781959870029</a>.
</div>
<div id="ref-Fox_Weisberg_2018" class="csl-entry" role="listitem">
Fox, John, and Sanford Weisberg. 2018. <em>An <span>R</span> Companion to Applied Regression</em>. 3rd Edition. Sage Publications.
</div>
<div id="ref-Gelman_Hill_Vehtari_2020" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Analytical Methods for Social Research. Cambridge University Press.
</div>
<div id="ref-loveridge2023" class="csl-entry" role="listitem">
Loveridge, Andrew J., Matthew Wijers, Roseline Mandisodza-Chikerema, David W. Macdonald, and Guillaume Chapron. 2023. <span>“Anthropogenic Edge Effects and Aging Errors by Hunters Can Affect the Sustainability of Lion Trophy Hunting.”</span> <em>Scientific Reports</em> 13 (1). <a href="https://doi.org/10.1038/s41598-022-25020-9">https://doi.org/10.1038/s41598-022-25020-9</a>.
</div>
<div id="ref-Morega_2020" class="csl-entry" role="listitem">
Morega, Paula. 2020. <em>Geospatial Health Data. Modelling and Visiualisation with r-INLA and Shiny</em>. Routledge/CRC Press.
</div>
<div id="ref-whitman2004" class="csl-entry" role="listitem">
Whitman, Karyl, Anthony M. Starfield, Henley S. Quadling, and Craig Packer. 2004. <span>“Sustainable Trophy Hunting of African Lions.”</span> <em>Nature</em> 428 (6979): 175–78. <a href="https://doi.org/10.1038/nature02395">https://doi.org/10.1038/nature02395</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{robinson2024,
  author = {Robinson, Paul},
  title = {2: {Simple} Linear Regression},
  date = {2024-08-17},
  url = {https://paulauvirage.github.io/posts/2024-08-19-simple-linear-regression/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-robinson2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Robinson, Paul. 2024. <span>“2: Simple Linear Regression.”</span> August
17, 2024. <a href="https://paulauvirage.github.io/posts/2024-08-19-simple-linear-regression/">https://paulauvirage.github.io/posts/2024-08-19-simple-linear-regression/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Written and designed by Paul Robinson, licenced under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC_SA 4.0</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <a href="https://github.com/paulauvirage/paulauvirage.github.io" target="_blank"><i class="fa-brands fa-github" title="GitHub octocat logo" aria-label="github"></i></a>, <a href="https://www.r-project.org/about.html" target="_blank"><i class="fa-brands fa-r-project" title="R Project" aria-label="r-project"></i></a> and <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>
  </div>
</footer>




<script src="../../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>